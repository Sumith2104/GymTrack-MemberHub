# Plan for Collecting and Using Data - Member Hub Application

This document outlines the data collection, usage, and protection strategy for the Member Hub application.

## 1. Data Collection

The following types of data are collected from and generated by users of the application:

### 1.1. Member Profile Information
- **What:** Name, email address, member ID, age, phone number, join date, membership details (type, status, expiry), and an optional profile picture URL.
- **How:** This data is primarily entered during member registration by gym staff and is looked up by the member upon login. Members can update some of this information (name, age, phone, email, profile picture) via the Settings page.

### 1.2. Authentication & Session Data
- **What:** Anonymous Firebase Authentication user ID (UID).
- **How:** When a user successfully looks up their profile, an anonymous Firebase user session is created and persisted in the browser. This UID is used to identify the user for secure data access without requiring a password. Session storage in the browser is used to remember the member ID and email for automatic login.

### 1.3. Fitness & Activity Data
- **Check-ins:** Timestamps for each gym check-in are recorded. This is currently simulated but designed to be triggered by an action (e.g., scanning a QR code).
- **Workout Logs:** Detailed records of workout sessions, including the date, notes, and a list of exercises with their corresponding sets, reps, and weight.
- **Body Weight Logs:** A history of the member's body weight, recorded with a date.

### 1.4. Communication Data
- **AI Chatbot History:** The conversation history (user prompts and AI responses) is stored to maintain context for the AI Fitness Assistant.
- **Admin Messages:** Direct messages sent between the member and the gym administration are stored.

## 2. Data Usage

The collected data is used exclusively to power the application's features and improve the user experience:

- **Profile Data:** Used for authentication, to display the member's information on the dashboard, to personalize communications (e.g., using their name), and to display their profile picture.
- **Check-in Data:** Powers the "Check-in History" page, provides data for the monthly visit frequency chart, and is used to calculate the "Workout Streak" displayed on the dashboard.
- **Workout & Weight Logs:** This data is crucial for the "Workout Tracking" section. It populates the workout history log, the body weight progress chart, and is automatically analyzed to calculate and display Personal Records (PRs).
- **AI Chatbot History:** Essential for providing context to the Gemini AI model, allowing for more relevant and conversational follow-up responses.
- **Admin Messages:** Enables the direct messaging feature between the member and gym staff.

## 3. Data Storage and Security

Data is stored and secured using a combination of Firebase and Supabase services.

- **Primary Database:** Google Firestore is the primary database for storing all user-generated data, including profiles, check-ins, workout logs, and messages.
- **File Storage:** Supabase Storage is used to securely store user-uploaded profile pictures.
- **Security:**
    - **Firestore Security Rules:** Access to data in Firestore is strictly controlled by security rules. These rules ensure that authenticated users can only read and write data that belongs to them (e.g., a user can only see their own check-in history or workout logs).
    - **Supabase Policies:** File access in Supabase Storage is governed by security policies that link file ownership to the user's ID, preventing unauthorized access to profile pictures.

## 4. Third-Party Services

- **Firebase (Google):** Used for core backend services, including Firestore (database) and Authentication (for session management).
- **Genkit with Google's Gemini API:** Powers the AI Fitness Assistant chatbot. Conversation history is sent to the API to generate responses.
- **Nodemailer:** Used to send transactional emails, such as the One-Time Password (OTP) for email address changes. This requires SMTP configuration from the gym's email provider.